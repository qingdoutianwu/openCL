name: "Collapsed Tiles - Unlock Monitor"
desc: "基于参考图修复：包含 Netflix / Disney+ / YouTube / ChatGPT 等服务的解锁检测，修复面板不显示问题。"
icon: "checklist"

# 修复要点：
# 1. 为每个 Tile 增加了 `url` 字段（点击图标跳转官网，这是参考图中显示的关键）。
# 2. 为每个 Tile 增加了 `argument: ""` 参数，确保脚本触发。
# 3. 移除了不稳定的 Summary 聚合脚本，改为独立展示，与参考图保持一致。

tiles:
  - name: Netflix-Check
    title: "Netflix"
    content: "Tap to refresh"
    icon: "play.rectangle.fill"
    collapsed: true
    url: "https://www.netflix.com"
    argument: ""

  - name: YouTube-Check
    title: "YouTube Premium"
    content: "Tap to refresh"
    icon: "play.fill"
    collapsed: true
    url: "https://www.youtube.com/premium"
    argument: ""

  - name: Disney-Check
    title: "Disney+"
    content: "Tap to refresh"
    icon: "sparkles.tv.fill"
    collapsed: true
    url: "https://www.disneyplus.com"
    argument: ""

  - name: Spotify-Check
    title: "Spotify"
    content: "Tap to refresh"
    icon: "music.note"
    collapsed: true
    url: "https://open.spotify.com"
    argument: ""

  - name: ChatGPT-Web-Check
    title: "ChatGPT Web"
    content: "Tap to refresh"
    icon: "bubble.left.and.bubble.right.fill"
    collapsed: true
    url: "https://chatgpt.com"
    argument: ""

  - name: Claude-Check
    title: "Claude AI"
    content: "Tap to refresh"
    icon: "sparkles"
    collapsed: true
    url: "https://claude.ai"
    argument: ""

  - name: HBO-Check
    title: "HBO Max"
    content: "Tap to refresh"
    icon: "tv.fill"
    collapsed: true
    url: "https://www.max.com"
    argument: ""

  - name: Prime-Check
    title: "Prime Video"
    content: "Tap to refresh"
    icon: "film.fill"
    collapsed: true
    url: "https://www.primevideo.com"
    argument: ""

script-providers:
  Netflix-Check:
    interval: 86400
    content: |
      $httpClient.get({ url: "https://www.netflix.com/title/81215567", headers: { "User-Agent": "Mozilla/5.0" }, timeout: 5000 }, (err, resp, body) => {
        if (err || !resp) return $done({ title: "Netflix", content: "⚠️ Request Failed", icon: "play.rectangle.fill" });
        if (resp.status === 200) return $done({ title: "Netflix", content: "✅ Unlocked", icon: "play.rectangle.fill" });
        if (resp.status === 404) return $done({ title: "Netflix", content: "❌ Blocked (404)", icon: "play.rectangle.fill" });
        return $done({ title: "Netflix", content: `❌ HTTP ${resp.status}`, icon: "play.rectangle.fill" });
      });

  YouTube-Check:
    interval: 86400
    content: |
      $httpClient.get({ url: "https://www.youtube.com/premium", headers: { "User-Agent": "Mozilla/5.0" }, timeout: 5000 }, (err, resp, body) => {
        if (err || !resp) return $done({ title: "YouTube", content: "⚠️ Request Failed", icon: "play.fill" });
        const t = String(body || "").toLowerCase();
        const blocked = t.includes("not available") && (t.includes("country") || t.includes("region"));
        if (resp.status >= 200 && resp.status < 400 && !blocked) return $done({ title: "YouTube", content: "✅ Unlocked (Premium)", icon: "play.fill" });
        return $done({ title: "YouTube", content: "❌ Geo Limited", icon: "play.fill" });
      });

  Disney-Check:
    interval: 86400
    content: |
      $httpClient.get({ url: "https://www.disneyplus.com/", headers: { "User-Agent": "Mozilla/5.0" }, timeout: 5000 }, (err, resp, body) => {
        if (err || !resp) return $done({ title: "Disney+", content: "⚠️ Request Failed", icon: "sparkles.tv.fill" });
        const t = String(body || "").toLowerCase();
        const blocked = t.includes("not available in your region") || t.includes("not available in your location");
        if (resp.status >= 200 && resp.status < 400 && !blocked) return $done({ title: "Disney+", content: "✅ Unlocked", icon: "sparkles.tv.fill" });
        return $done({ title: "Disney+", content: "❌ Geo Blocked", icon: "sparkles.tv.fill" });
      });

  Spotify-Check:
    interval: 86400
    content: |
      $httpClient.get({ url: "https://www.spotify.com/", headers: { "User-Agent": "Mozilla/5.0" }, timeout: 5000 }, (err, resp, body) => {
        if (err || !resp) return $done({ title: "Spotify", content: "⚠️ Request Failed", icon: "music.note" });
        const t = String(body || "").toLowerCase();
        const blocked = t.includes("spotify is currently not available") || t.includes("not available in your country");
        if (resp.status >= 200 && resp.status < 400 && !blocked) return $done({ title: "Spotify", content: "✅ Unlocked", icon: "music.note" });
        return $done({ title: "Spotify", content: "❌ Geo Blocked", icon: "music.note" });
      });

  ChatGPT-Web-Check:
    interval: 86400
    content: |
      $httpClient.get({ url: "https://chatgpt.com/", headers: { "User-Agent": "Mozilla/5.0" }, timeout: 5000 }, (err, resp, body) => {
        if (err || !resp) return $done({ title: "ChatGPT Web", content: "⚠️ Request Failed", icon: "bubble.left.and.bubble.right.fill" });
        if (resp.status === 403) return $done({ title: "ChatGPT Web", content: "❌ Blocked (403)", icon: "bubble.left.and.bubble.right.fill" });
        if (resp.status >= 200 && resp.status < 400) return $done({ title: "ChatGPT Web", content: "✅ Reachable", icon: "bubble.left.and.bubble.right.fill" });
        return $done({ title: "ChatGPT Web", content: `❌ HTTP ${resp.status}`, icon: "bubble.left.and.bubble.right.fill" });
      });

  Claude-Check:
    interval: 86400
    content: |
      $httpClient.get({ url: "https://claude.ai/login", headers: { "User-Agent": "Mozilla/5.0" }, timeout: 5000 }, (err, resp, body) => {
        if (err || !resp) return $done({ title: "Claude AI", content: "⚠️ Request Failed", icon: "sparkles" });
        const t = String(body || "").toLowerCase();
        if (resp.status === 403 || t.includes("app unavailable")) return $done({ title: "Claude AI", content: "❌ Geo Blocked", icon: "sparkles" });
        if (resp.status >= 200 && resp.status < 400) return $done({ title: "Claude AI", content: "✅ Reachable", icon: "sparkles" });
        return $done({ title: "Claude AI", content: `❌ HTTP ${resp.status}`, icon: "sparkles" });
      });

  HBO-Check:
    interval: 86400
    content: |
      $httpClient.get({ url: "https://www.max.com/", headers: { "User-Agent": "Mozilla/5.0" }, timeout: 5000 }, (err, resp, body) => {
        if (err || !resp) return $done({ title: "HBO Max", content: "⚠️ Request Failed", icon: "tv.fill" });
        const t = String(body || "").toLowerCase();
        const blocked = t.includes("not available") && t.includes("region");
        if (resp.status >= 200 && resp.status < 400 && !blocked) return $done({ title: "HBO Max", content: "✅ Unlocked", icon: "tv.fill" });
        return $done({ title: "HBO Max", content: "❌ Geo Blocked", icon: "tv.fill" });
      });

  Prime-Check:
    interval: 86400
    content: |
      $httpClient.get({ url: "https://www.primevideo.com/", headers: { "User-Agent": "Mozilla/5.0" }, timeout: 5000 }, (err, resp, body) => {
        if (err || !resp) return $done({ title: "Prime Video", content: "⚠️ Request Failed", icon: "film.fill" });
        const t = String(body || "").toLowerCase();
        const blocked = t.includes("not available in your location") || t.includes("not available in your region") || t.includes("unavailable in your region");
        if (resp.status === 403) return $done({ title: "Prime Video", content: "❌ Denied (403)", icon: "film.fill" });
        if (resp.status >= 200 && resp.status < 400 && !blocked) return $done({ title: "Prime Video", content: "✅ Unlocked", icon: "film.fill" });
        return $done({ title: "Prime Video", content: "❌ Geo Blocked", icon: "film.fill" });
      });
