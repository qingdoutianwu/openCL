name: Collapsed Tiles - Unlock Monitor (Local Fixed)
desc: "本地修复版：移除了 SUBSCRIBED 标记，强制显示所有内嵌脚本 Tile。"

# ==========================================
# ⚠️ 重要：绝对不要在第一行加 #SUBSCRIBED
# ==========================================

tiles:
  # --- 1. 官方远程脚本 (原本能显示) ---
  - name: ChatGPT-Web-Check
    title: ChatGPT Web
    icon: https://fastly.jsdelivr.net/gh/StashNetworks/misc@main/collapsed-tiles/img/chatgpt.png
    collapsed: true
    url: https://chatgpt.com

  - name: ChatGPT-App-Check
    title: ChatGPT App
    icon: https://fastly.jsdelivr.net/gh/StashNetworks/misc@main/collapsed-tiles/img/chatgpt.png
    collapsed: true
    url: https://chatgpt.com

  - name: YouTube-Check
    title: YouTube
    icon: https://fastly.jsdelivr.net/gh/StashNetworks/misc@main/collapsed-tiles/img/youtube.png
    collapsed: true
    url: https://www.youtube.com

  - name: Netflix-Check
    title: Netflix
    icon: https://fastly.jsdelivr.net/gh/StashNetworks/misc@main/collapsed-tiles/img/netflix.png
    collapsed: true
    url: https://www.netflix.com

  # --- 2. 内嵌脚本 (通过删除订阅头 + 添加 argument 修复) ---
  - name: Disney-Check
    title: Disney+
    icon: https://fastly.jsdelivr.net/gh/Koolson/Qure/IconSet/Color/Disney+.png
    collapsed: true
    url: https://www.disneyplus.com
    argument: "check"

  - name: Spotify-Check
    title: Spotify
    icon: https://fastly.jsdelivr.net/gh/Koolson/Qure/IconSet/Color/Spotify.png
    collapsed: true
    url: https://open.spotify.com
    argument: "check"

  - name: Claude-Check
    title: Claude
    icon: https://fastly.jsdelivr.net/gh/Koolson/Qure/IconSet/Color/Claude.png
    collapsed: true
    url: https://claude.ai
    argument: "check"

  - name: HBO-Max-Check
    title: HBO Max
    icon: https://fastly.jsdelivr.net/gh/Koolson/Qure/IconSet/Color/HBO_Max.png
    collapsed: true
    url: https://www.max.com
    argument: "check"

  - name: PrimeVideo-Check
    title: Prime Video
    icon: https://fastly.jsdelivr.net/gh/Koolson/Qure/IconSet/Color/Amazon_Prime_Video.png
    collapsed: true
    url: https://www.primevideo.com
    argument: "check"

# ==========================================
# 脚本逻辑
# ==========================================
script-providers:
  # --- 官方源 ---
  ChatGPT-Web-Check:
    url: https://fastly.jsdelivr.net/gh/StashNetworks/misc@main/collapsed-tiles/script/chatgpt-web.js
    interval: 86400
  ChatGPT-App-Check:
    url: https://fastly.jsdelivr.net/gh/StashNetworks/misc@main/collapsed-tiles/script/chatgpt-app.js
    interval: 86400
  YouTube-Check:
    url: https://fastly.jsdelivr.net/gh/StashNetworks/misc@main/collapsed-tiles/script/youtube.js
    interval: 86400
  Netflix-Check:
    url: https://fastly.jsdelivr.net/gh/StashNetworks/misc@main/collapsed-tiles/script/netflix.js
    interval: 86400

  # --- 内嵌源 (IIFE 模式防止变量冲突) ---
  Disney-Check:
    interval: 86400
    content: |
      (function(){
        const url="https://www.disneyplus.com/";
        $httpClient.get({url:url, headers:{"User-Agent":"Mozilla/5.0"}, timeout:5000}, (e,r,b)=>{
          const icon="https://fastly.jsdelivr.net/gh/Koolson/Qure/IconSet/Color/Disney+.png";
          if(e||!r) return $done({title:"Disney+", content:"Error", icon:icon});
          const t=String(b).toLowerCase();
          if(r.status===200 && !t.includes("not available in your region")) $done({title:"Disney+", content:"Unlocked", icon:icon});
          else $done({title:"Disney+", content:"Blocked", icon:icon});
        });
      })();

  Spotify-Check:
    interval: 86400
    content: |
      (function(){
        const url="https://open.spotify.com";
        $httpClient.get({url:url, headers:{"User-Agent":"Mozilla/5.0"}, timeout:5000}, (e,r,b)=>{
          const icon="https://fastly.jsdelivr.net/gh/Koolson/Qure/IconSet/Color/Spotify.png";
          if(e||!r) return $done({title:"Spotify", content:"Error", icon:icon});
          const t=String(b).toLowerCase();
          if(r.status===200 && !t.includes("not available")) $done({title:"Spotify", content:"Unlocked", icon:icon});
          else $done({title:"Spotify", content:"Blocked", icon:icon});
        });
      })();

  Claude-Check:
    interval: 86400
    content: |
      (function(){
        const url="https://claude.ai/login";
        $httpClient.get({url:url, headers:{"User-Agent":"Mozilla/5.0"}, timeout:5000}, (e,r,b)=>{
          const icon="https://fastly.jsdelivr.net/gh/Koolson/Qure/IconSet/Color/Claude.png";
          if(e||!r) return $done({title:"Claude", content:"Error", icon:icon});
          const t=String(b).toLowerCase();
          if(r.status===200 && !t.includes("app unavailable") && r.status!==403) $done({title:"Claude", content:"Unlocked", icon:icon});
          else $done({title:"Claude", content:"Blocked", icon:icon});
        });
      })();

  HBO-Max-Check:
    interval: 86400
    content: |
      (function(){
        const url="https://www.max.com/";
        $httpClient.get({url:url, headers:{"User-Agent":"Mozilla/5.0"}, timeout:5000}, (e,r,b)=>{
          const icon="https://fastly.jsdelivr.net/gh/Koolson/Qure/IconSet/Color/HBO_Max.png";
          if(e||!r) return $done({title:"HBO Max", content:"Error", icon:icon});
          const t=String(b).toLowerCase();
          if(r.status===200 && !t.includes("not available")) $done({title:"HBO Max", content:"Unlocked", icon:icon});
          else $done({title:"HBO Max", content:"Blocked", icon:icon});
        });
      })();

  PrimeVideo-Check:
    interval: 86400
    content: |
      (function(){
        const url="https://www.primevideo.com/";
        $httpClient.get({url:url, headers:{"User-Agent":"Mozilla/5.0"}, timeout:5000}, (e,r,b)=>{
          const icon="https://fastly.jsdelivr.net/gh/Koolson/Qure/IconSet/Color/Amazon_Prime_Video.png";
          if(e||!r) return $done({title:"Prime Video", content:"Error", icon:icon});
          const t=String(b).toLowerCase();
          if(r.status===200 && !t.includes("not available") && !t.includes("unavailable")) $done({title:"Prime Video", content:"Unlocked", icon:icon});
          else $done({title:"Prime Video", content:"Blocked", icon:icon});
        });
      })();
